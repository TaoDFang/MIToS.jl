<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Change B-factors · MIToS</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">MIToS</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../Installation/">Installation</a></li><li><a class="tocitem" href="../Example/">Example</a></li><li><span class="tocitem">Modules</span><ul><li><a class="tocitem" href="../MSA/">MSA</a></li><li><a class="tocitem" href="../Information/">Information</a></li><li><a class="tocitem" href="../SIFTS/">SIFTS</a></li><li><a class="tocitem" href="../PDB/">PDB</a></li></ul></li><li><a class="tocitem" href="../Scripts/">Scripts</a></li><li><span class="tocitem">Cookbook</span><ul><li class="is-active"><a class="tocitem" href>Change B-factors</a><ul class="internal"><li><a class="tocitem" href="#Problem-description"><span>Problem description</span></a></li><li><a class="tocitem" href="#MIToS-solution"><span>MIToS solution</span></a></li><li><a class="tocitem" href="#Discussion"><span>Discussion</span></a></li></ul></li><li><a class="tocitem" href="../02_Linking_structural_and_evolutionary_information/">Linking structural and evolutionary information</a></li><li><a class="tocitem" href="../03_RMSF/">Root Mean Squared Fluctuation (RMSF)</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../MSA_API/">MSA</a></li><li><a class="tocitem" href="../Information_API/">Information</a></li><li><a class="tocitem" href="../SIFTS_API/">SIFTS</a></li><li><a class="tocitem" href="../PDB_API/">PDB</a></li><li><a class="tocitem" href="../Pfam_API/">Pfam</a></li><li><a class="tocitem" href="../Utils_API/">Utils</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Cookbook</a></li><li class="is-active"><a href>Change B-factors</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Change B-factors</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/diegozea/MIToS.jl/blob/master/docs/src/cookbook/01_Change_B_factors.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Change-B-factors"><a class="docs-heading-anchor" href="#Change-B-factors">Change B-factors</a><a id="Change-B-factors-1"></a><a class="docs-heading-anchor-permalink" href="#Change-B-factors" title="Permalink"></a></h1><p>md <code>@setup log md @info Cookbook: Change B-factors md</code></p><p>md # <a href="https://mybinder.org/v2/gh/diegozea/MIToS.jl/gh-pages?filepath=devcookbook/notebooks/01_Change_B_factors.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> md # <a href="https://nbviewer.jupyter.org/github/diegozea/MIToS.jl/blob/gh-pages/devcookbook/notebooks/01_Change_B_factors.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><h2 id="Problem-description"><a class="docs-heading-anchor" href="#Problem-description">Problem description</a><a id="Problem-description-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-description" title="Permalink"></a></h2><p>It is a common practice to change the B-factors of a PDB to store information about atoms or residues to be used by other programs. In particular, values in the B-factor column can be easily used to colour residues with <a href="https://pymolwiki.org/index.php/Color#B-Factors">PyMOL</a> or <a href="https://www.cgl.ucsf.edu/chimera/docs/UsersGuide/tutorials/bfactor.html">Chimera</a>.</p><p>We cannot simply assign a new value to the <code>B</code> field of a <code>PDBAtom</code> because this type is immutable. However, we can make use of the <code>@set</code> macro of the <a href="https://github.com/jw3126/Setfield.jl">Setfield</a> package to create a new <code>PDBAtom</code> with a different B-factor value.</p><p>In a PDB file, B-factors are stored from the column 61 to 66. Therefore, new B-factors should be a <code>String</code> with 6 or fewer characters, normally using two characters for decimal values. We can use <code>fmt</code> and <code>FormatSpec</code> from the <a href="https://github.com/JuliaIO/Formatting.jl">Formatting</a> package to create a proper B-factor string.</p><h2 id="MIToS-solution"><a class="docs-heading-anchor" href="#MIToS-solution">MIToS solution</a><a id="MIToS-solution-1"></a><a class="docs-heading-anchor-permalink" href="#MIToS-solution" title="Permalink"></a></h2><p>For this example we are going to use the small heat shock protein AgsA from <em>Salmonella typhimurium</em> (PDB code: <em>4ZJ9</em>) available in MIToS docs data:</p><pre><code class="language-julia">using MIToS
pdbfile = abspath(pathof(MIToS), &quot;..&quot;, &quot;..&quot;, &quot;docs&quot;, &quot;data&quot;, &quot;4zj9.pdb&quot;)</code></pre><pre class="documenter-example-output">&quot;/home/travis/build/diegozea/MIToS.jl/docs/data/4zj9.pdb&quot;</pre><p>md nothing # hide</p><p>First, we need to read the PDB file using the <code>MIToS.PDB</code> module:</p><pre><code class="language-julia">using MIToS.PDB
pdb_residues = read(pdbfile, PDBFile)</code></pre><pre class="documenter-example-output">122-element Array{MIToS.PDB.PDBResidue,1}:
 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;            &quot;40&quot;           &quot;ALA&quot;          &quot;ATOM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 5
		                                                  coordinates            atom         element       occupancy               B
		1:                                   [-9.444, 55.036, 86.886]             &quot;N&quot;             &quot;N&quot;             1.0         &quot;98.52&quot;
		                                                  coordinates            atom         element       occupancy               B
		2:                                    [-8.02, 54.714, 86.503]            &quot;CA&quot;             &quot;C&quot;             1.0         &quot;96.90&quot;
		                                                  coordinates            atom         element       occupancy               B
		3:                                    [-7.044, 55.568, 87.32]             &quot;C&quot;             &quot;C&quot;             1.0         &quot;82.45&quot;
		                                                  coordinates            atom         element       occupancy               B
		4:                                   [-6.885, 56.778, 87.084]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;89.60&quot;
		                                                  coordinates            atom         element       occupancy               B
		5:                                   [-7.793, 54.915, 85.004]            &quot;CB&quot;             &quot;C&quot;             1.0        &quot;101.14&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;            &quot;41&quot;           &quot;THR&quot;          &quot;ATOM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 7
		                                                  coordinates            atom         element       occupancy               B
		1:                                   [-6.416, 54.928, 88.309]             &quot;N&quot;             &quot;N&quot;             1.0         &quot;65.70&quot;
		                                                  coordinates            atom         element       occupancy               B
		2:                                   [-5.427, 55.594, 89.166]            &quot;CA&quot;             &quot;C&quot;             1.0         &quot;51.99&quot;
		                                                  coordinates            atom         element       occupancy               B
		3:                                   [-4.005, 55.239, 88.708]             &quot;C&quot;             &quot;C&quot;             1.0         &quot;50.02&quot;
		                                                  coordinates            atom         element       occupancy               B
		4:                                    [-3.747, 54.126, 88.21]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;43.89&quot;
		                                                  coordinates            atom         element       occupancy               B
		5:                                   [-5.581, 55.215, 90.655]            &quot;CB&quot;             &quot;C&quot;             1.0         &quot;56.16&quot;
		                                                  coordinates            atom         element       occupancy               B
		6:                                    [-5.354, 53.81, 90.846]           &quot;OG1&quot;             &quot;O&quot;             1.0         &quot;50.36&quot;
		                                                  coordinates            atom         element       occupancy               B
		7:                                   [-6.974, 55.579, 91.181]           &quot;CG2&quot;             &quot;C&quot;             1.0         &quot;69.82&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;            &quot;42&quot;           &quot;PRO&quot;          &quot;ATOM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 7
		                                                  coordinates            atom         element       occupancy               B
		1:                                   [-3.071, 56.171, 88.866]             &quot;N&quot;             &quot;N&quot;             1.0         &quot;49.68&quot;
		                                                  coordinates            atom         element       occupancy               B
		2:                                   [-1.745, 55.865, 88.379]            &quot;CA&quot;             &quot;C&quot;             1.0         &quot;44.17&quot;
		                                                  coordinates            atom         element       occupancy               B
		3:                                    [-1.123, 54.698, 89.04]             &quot;C&quot;             &quot;C&quot;             1.0         &quot;42.85&quot;
		                                                  coordinates            atom         element       occupancy               B
		4:                                   [-1.231, 54.504, 90.275]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;41.81&quot;
		                                                  coordinates            atom         element       occupancy               B
		5:                                   [-0.951, 57.155, 88.677]            &quot;CB&quot;             &quot;C&quot;             1.0         &quot;46.28&quot;
		                                                  coordinates            atom         element       occupancy               B
		6:                                   [-1.954, 58.203, 88.906]            &quot;CG&quot;             &quot;C&quot;             1.0         &quot;49.44&quot;
		                                                  coordinates            atom         element       occupancy               B
		7:                                   [-3.117, 57.487, 89.533]            &quot;CD&quot;             &quot;C&quot;             1.0         &quot;46.54&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;            &quot;43&quot;           &quot;ALA&quot;          &quot;ATOM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 5
		                                                  coordinates            atom         element       occupancy               B
		1:                                    [-0.41, 53.906, 88.247]             &quot;N&quot;             &quot;N&quot;             1.0         &quot;37.01&quot;
		                                                  coordinates            atom         element       occupancy               B
		2:                                    [0.407, 52.858, 88.791]            &quot;CA&quot;             &quot;C&quot;             1.0         &quot;35.64&quot;
		                                                  coordinates            atom         element       occupancy               B
		3:                                     [1.457, 53.452, 89.72]             &quot;C&quot;             &quot;C&quot;             1.0         &quot;31.47&quot;
		                                                  coordinates            atom         element       occupancy               B
		4:                                    [1.909, 54.569, 89.511]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;40.80&quot;
		                                                  coordinates            atom         element       occupancy               B
		5:                                    [1.063, 52.094, 87.626]            &quot;CB&quot;             &quot;C&quot;             1.0         &quot;41.92&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;            &quot;44&quot;           &quot;TYR&quot;          &quot;ATOM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 12
		                                                  coordinates            atom         element       occupancy               B
		1:                                     [1.852, 52.735, 90.73]             &quot;N&quot;             &quot;N&quot;             1.0         &quot;34.81&quot;
		                                                  coordinates            atom         element       occupancy               B
		2:                                    [2.932, 53.161, 91.566]            &quot;CA&quot;             &quot;C&quot;             1.0         &quot;36.17&quot;
		                                                  coordinates            atom         element       occupancy               B
		3:                                       [3.76, 51.96, 92.06]             &quot;C&quot;             &quot;C&quot;             1.0         &quot;35.74&quot;
		                                                  coordinates            atom         element       occupancy               B
		4:                                      [3.345, 50.775, 92.0]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;36.81&quot;
		                                                  coordinates            atom         element       occupancy               B
		5:                                    [2.433, 54.053, 92.736]            &quot;CB&quot;             &quot;C&quot;             1.0         &quot;34.90&quot;
		                                                  coordinates            atom         element       occupancy               B
		6:                                    [1.619, 53.295, 93.789]            &quot;CG&quot;             &quot;C&quot;             1.0         &quot;37.37&quot;
		                                                  coordinates            atom         element       occupancy               B
		7:                                    [0.249, 53.157, 93.674]           &quot;CD1&quot;             &quot;C&quot;             1.0         &quot;38.52&quot;
		                                                  coordinates            atom         element       occupancy               B
		8:                                    [2.243, 52.726, 94.923]           &quot;CD2&quot;             &quot;C&quot;             1.0         &quot;39.07&quot;
		                                                  coordinates            atom         element       occupancy               B
		9:                                   [-0.486, 52.426, 94.604]           &quot;CE1&quot;             &quot;C&quot;             1.0         &quot;40.94&quot;
		                                                  coordinates            atom         element       occupancy               B
		10:                                   [1.514, 52.032, 95.884]           &quot;CE2&quot;             &quot;C&quot;             1.0         &quot;41.80&quot;
		                                                  coordinates            atom         element       occupancy               B
		11:                                    [0.157, 51.86, 95.707]            &quot;CZ&quot;             &quot;C&quot;             1.0         &quot;45.79&quot;
		                                                  coordinates            atom         element       occupancy               B
		12:                                    [-0.56, 51.19, 96.676]            &quot;OH&quot;             &quot;O&quot;             1.0         &quot;53.01&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;            &quot;45&quot;           &quot;ASP&quot;          &quot;ATOM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 8
		                                                  coordinates            atom         element       occupancy               B
		1:                                    [4.935, 52.284, 92.562]             &quot;N&quot;             &quot;N&quot;             1.0         &quot;32.18&quot;
		                                                  coordinates            atom         element       occupancy               B
		2:                                    [5.806, 51.338, 93.184]            &quot;CA&quot;             &quot;C&quot;             1.0         &quot;32.84&quot;
		                                                  coordinates            atom         element       occupancy               B
		3:                                    [6.059, 51.913, 94.555]             &quot;C&quot;             &quot;C&quot;             1.0         &quot;34.61&quot;
		                                                  coordinates            atom         element       occupancy               B
		4:                                    [6.093, 53.139, 94.748]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;35.52&quot;
		                                                  coordinates            atom         element       occupancy               B
		5:                                    [7.163, 51.293, 92.509]            &quot;CB&quot;             &quot;C&quot;             1.0         &quot;36.45&quot;
		                                                  coordinates            atom         element       occupancy               B
		6:                                    [7.155, 50.564, 91.166]            &quot;CG&quot;             &quot;C&quot;             1.0         &quot;36.82&quot;
		                                                  coordinates            atom         element       occupancy               B
		7:                                    [6.171, 49.835, 90.816]           &quot;OD1&quot;             &quot;O&quot;             1.0         &quot;34.26&quot;
		                                                  coordinates            atom         element       occupancy               B
		8:                                      [8.15, 50.765, 90.45]           &quot;OD2&quot;             &quot;O&quot;             1.0         &quot;37.42&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;            &quot;46&quot;           &quot;LEU&quot;          &quot;ATOM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 8
		                                                  coordinates            atom         element       occupancy               B
		1:                                      [6.338, 51.018, 95.5]             &quot;N&quot;             &quot;N&quot;             1.0         &quot;36.52&quot;
		                                                  coordinates            atom         element       occupancy               B
		2:                                    [6.744, 51.435, 96.835]            &quot;CA&quot;             &quot;C&quot;             1.0         &quot;36.99&quot;
		                                                  coordinates            atom         element       occupancy               B
		3:                                    [7.904, 50.612, 97.233]             &quot;C&quot;             &quot;C&quot;             1.0         &quot;36.32&quot;
		                                                  coordinates            atom         element       occupancy               B
		4:                                    [7.836, 49.358, 97.224]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;39.74&quot;
		                                                  coordinates            atom         element       occupancy               B
		5:                                    [5.569, 51.282, 97.827]            &quot;CB&quot;             &quot;C&quot;             1.0         &quot;41.44&quot;
		                                                  coordinates            atom         element       occupancy               B
		6:                                    [5.846, 51.797, 99.237]            &quot;CG&quot;             &quot;C&quot;             1.0         &quot;45.92&quot;
		                                                  coordinates            atom         element       occupancy               B
		7:                                    [6.076, 53.309, 99.286]           &quot;CD1&quot;             &quot;C&quot;             1.0         &quot;48.04&quot;
		                                                  coordinates            atom         element       occupancy               B
		8:                                    [4.64, 51.366, 100.069]           &quot;CD2&quot;             &quot;C&quot;             1.0         &quot;54.41&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;            &quot;47&quot;           &quot;GLN&quot;          &quot;ATOM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 9
		                                                  coordinates            atom         element       occupancy               B
		1:                                    [9.001, 51.276, 97.511]             &quot;N&quot;             &quot;N&quot;             1.0         &quot;34.90&quot;
		                                                  coordinates            atom         element       occupancy               B
		2:                                    [10.166, 50.57, 97.947]            &quot;CA&quot;             &quot;C&quot;             1.0         &quot;36.55&quot;
		                                                  coordinates            atom         element       occupancy               B
		3:                                      [10.6, 51.001, 99.32]             &quot;C&quot;             &quot;C&quot;             1.0         &quot;40.16&quot;
		                                                  coordinates            atom         element       occupancy               B
		4:                                   [10.295, 52.093, 99.767]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;40.35&quot;
		                                                  coordinates            atom         element       occupancy               B
		5:                                   [11.336, 50.876, 96.991]            &quot;CB&quot;             &quot;C&quot;             1.0         &quot;41.84&quot;
		                                                  coordinates            atom         element       occupancy               B
		6:                                    [11.14, 50.318, 95.608]            &quot;CG&quot;             &quot;C&quot;             1.0         &quot;44.09&quot;
		                                                  coordinates            atom         element       occupancy               B
		7:                                    [12.06, 51.025, 94.588]            &quot;CD&quot;             &quot;C&quot;             1.0         &quot;46.52&quot;
		                                                  coordinates            atom         element       occupancy               B
		8:                                    [11.659, 51.956, 93.95]           &quot;OE1&quot;             &quot;O&quot;             1.0         &quot;46.53&quot;
		                                                  coordinates            atom         element       occupancy               B
		9:                                    [13.311, 50.609, 94.52]           &quot;NE2&quot;             &quot;N&quot;             1.0         &quot;51.03&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;            &quot;48&quot;           &quot;LYS&quot;          &quot;ATOM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 9
		                                                  coordinates            atom         element       occupancy               B
		1:                                   [11.323, 50.105, 99.979]             &quot;N&quot;             &quot;N&quot;             1.0         &quot;41.83&quot;
		                                                  coordinates            atom         element       occupancy               B
		2:                                  [11.928, 50.297, 101.304]            &quot;CA&quot;             &quot;C&quot;             1.0         &quot;47.27&quot;
		                                                  coordinates            atom         element       occupancy               B
		3:                                  [13.488, 50.323, 101.061]             &quot;C&quot;             &quot;C&quot;             1.0         &quot;58.71&quot;
		                                                  coordinates            atom         element       occupancy               B
		4:                                  [14.071, 49.283, 100.742]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;68.67&quot;
		                                                  coordinates            atom         element       occupancy               B
		5:                                  [11.434, 49.136, 102.198]            &quot;CB&quot;             &quot;C&quot;             1.0         &quot;50.85&quot;
		                                                  coordinates            atom         element       occupancy               B
		6:                                  [11.747, 49.188, 103.684]            &quot;CG&quot;             &quot;C&quot;             1.0         &quot;57.43&quot;
		                                                  coordinates            atom         element       occupancy               B
		7:                                    [10.96, 48.09, 104.466]            &quot;CD&quot;             &quot;C&quot;             1.0         &quot;65.66&quot;
		                                                  coordinates            atom         element       occupancy               B
		8:                                   [11.25, 46.659, 103.944]            &quot;CE&quot;             &quot;C&quot;             1.0         &quot;73.85&quot;
		                                                  coordinates            atom         element       occupancy               B
		9:                                  [10.769, 45.506, 104.793]            &quot;NZ&quot;             &quot;N&quot;             1.0         &quot;77.15&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;            &quot;49&quot;           &quot;ARG&quot;          &quot;ATOM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 6
		                                                  coordinates            atom         element       occupancy               B
		1:                                  [14.129, 51.499, 101.133]             &quot;N&quot;             &quot;N&quot;             1.0         &quot;77.77&quot;
		                                                  coordinates            atom         element       occupancy               B
		2:                                   [15.589, 51.61, 100.904]            &quot;CA&quot;             &quot;C&quot;             1.0        &quot;103.66&quot;
		                                                  coordinates            atom         element       occupancy               B
		3:                                   [16.34, 51.018, 102.092]             &quot;C&quot;             &quot;C&quot;             1.0         &quot;97.50&quot;
		                                                  coordinates            atom         element       occupancy               B
		4:                                  [17.433, 50.488, 101.946]             &quot;O&quot;             &quot;O&quot;             1.0        &quot;117.85&quot;
		                                                  coordinates            atom         element       occupancy               B
		5:                                  [16.023, 53.064, 100.702]            &quot;CB&quot;             &quot;C&quot;             1.0         &quot;91.49&quot;
		                                                  coordinates            atom         element       occupancy               B
		6:                                   [15.352, 53.799, 99.549]            &quot;CG&quot;             &quot;C&quot;             1.0         &quot;90.58&quot;

 ⋮
 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;           &quot;320&quot;           &quot;HOH&quot;        &quot;HETATM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 1
		                                                  coordinates            atom         element       occupancy               B
		1:                                   [12.466, 64.057, 82.324]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;54.76&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;           &quot;321&quot;           &quot;HOH&quot;        &quot;HETATM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 1
		                                                  coordinates            atom         element       occupancy               B
		1:                                   [-8.596, 75.746, 73.668]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;67.34&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;           &quot;322&quot;           &quot;HOH&quot;        &quot;HETATM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 1
		                                                  coordinates            atom         element       occupancy               B
		1:                                   [4.831, 67.989, 102.947]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;72.21&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;           &quot;323&quot;           &quot;HOH&quot;        &quot;HETATM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 1
		                                                  coordinates            atom         element       occupancy               B
		1:                                    [3.357, 52.828, 84.078]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;54.67&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;           &quot;324&quot;           &quot;HOH&quot;        &quot;HETATM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 1
		                                                  coordinates            atom         element       occupancy               B
		1:                                   [-9.378, 57.248, 69.844]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;56.15&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;           &quot;325&quot;           &quot;HOH&quot;        &quot;HETATM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 1
		                                                  coordinates            atom         element       occupancy               B
		1:                                    [2.963, 70.306, 96.237]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;52.49&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;           &quot;326&quot;           &quot;HOH&quot;        &quot;HETATM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 1
		                                                  coordinates            atom         element       occupancy               B
		1:                                  [-10.407, 63.643, 85.296]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;60.28&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;           &quot;327&quot;           &quot;HOH&quot;        &quot;HETATM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 1
		                                                  coordinates            atom         element       occupancy               B
		1:                                   [-3.469, 63.492, 77.523]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;61.39&quot;

 PDBResidue:
	id::PDBResidueIdentifier
		    PDBe_number          number            name           group           model           chain
		             &quot;&quot;           &quot;328&quot;           &quot;HOH&quot;        &quot;HETATM&quot;             &quot;1&quot;             &quot;A&quot;
	atoms::Vector{PDBAtom}	length: 1
		                                                  coordinates            atom         element       occupancy               B
		1:                                   [-0.711, 62.917, 77.897]             &quot;O&quot;             &quot;O&quot;             1.0         &quot;56.10&quot;
</pre><p>md nothing # hide</p><p>For this example, we are going to replace the B-factor of the alpha-carbons by the residue hydrophobicity according to the hydrophobicity scale of <a href="https://doi.org/10.1016/0022-2836(82)90515-0">Kyte and Doolittle</a> used by <a href="https://www.cgl.ucsf.edu/chimera/docs/UsersGuide/midas/hydrophob.html">Chimera</a>:</p><pre><code class="language-julia">hydrophobicity = Dict(
	&quot;ILE&quot; =&gt; 4.5,
	&quot;VAL&quot; =&gt; 4.2,
	&quot;LEU&quot; =&gt; 3.8,
	&quot;PHE&quot; =&gt; 2.8,
	&quot;CYS&quot; =&gt; 2.5,
	&quot;MET&quot; =&gt; 1.9,
	&quot;ALA&quot; =&gt; 1.8,
	&quot;GLY&quot; =&gt; -0.4,
	&quot;THR&quot; =&gt; -0.7,
	&quot;SER&quot; =&gt; -0.8,
	&quot;TRP&quot; =&gt; -0.9,
	&quot;TYR&quot; =&gt; -1.3,
	&quot;PRO&quot; =&gt; -1.6,
	&quot;HIS&quot; =&gt; -3.2,
	&quot;GLU&quot; =&gt; -3.5,
	&quot;GLN&quot; =&gt; -3.5,
	&quot;ASP&quot; =&gt; -3.5,
	&quot;ASN&quot; =&gt; -3.5,
	&quot;LYS&quot; =&gt; -3.9,
	&quot;ARG&quot; =&gt; -4.5 )</code></pre><pre class="documenter-example-output">Dict{String,Float64} with 20 entries:
  &quot;GLN&quot; =&gt; -3.5
  &quot;LYS&quot; =&gt; -3.9
  &quot;GLY&quot; =&gt; -0.4
  &quot;ASN&quot; =&gt; -3.5
  &quot;TRP&quot; =&gt; -0.9
  &quot;THR&quot; =&gt; -0.7
  &quot;VAL&quot; =&gt; 4.2
  &quot;SER&quot; =&gt; -0.8
  &quot;HIS&quot; =&gt; -3.2
  &quot;PRO&quot; =&gt; -1.6
  &quot;PHE&quot; =&gt; 2.8
  &quot;ASP&quot; =&gt; -3.5
  &quot;ILE&quot; =&gt; 4.5
  &quot;TYR&quot; =&gt; -1.3
  &quot;ARG&quot; =&gt; -4.5
  &quot;LEU&quot; =&gt; 3.8
  &quot;ALA&quot; =&gt; 1.8
  &quot;MET&quot; =&gt; 1.9
  &quot;CYS&quot; =&gt; 2.5
  &quot;GLU&quot; =&gt; -3.5</pre><p>md nothing # hide</p><p>First, we define a helper function using <code>Formatting</code> to create a proper B-factor string with the PDB format; 6 characters and 2 digits after the decimal point. The <a href="https://www.wwpdb.org/documentation/file-format-content/format23/sect9.html">PDB format description</a> describe this field as:</p><pre><code class="language-none">COLUMNS      DATA TYPE        FIELD      DEFINITION
------------------------------------------------------
61 - 66      Real(6.2)        tempFactor Temperature factor.</code></pre><pre><code class="language-julia">using Formatting

&quot;Return value as a string with the B factor format described in PDB.&quot;
format_b_factor(value) = fmt(FormatSpec(&quot;6.2f&quot;), value) # e.g. 1.5 -&gt; &quot;  1.50&quot;</code></pre><pre class="documenter-example-output">Main.ex-01_Change_B_factors.format_b_factor</pre><p>md nothing # hide</p><p>Then, where are using that helper function to define a function that returns a new <code>PDBAtom</code> by changing the <code>B</code> factor field using the <code>Setfield</code> package.</p><pre><code class="language-julia">using Setfield

&quot;Return a new PDBAtom with the B-factor changed to value.&quot;
function change_b_factor(atom::PDBAtom, value)
	b_factor_string = format_b_factor(value)
	b_factor_string = strip(b_factor_string) # e.g. &quot;  1.50&quot; -&gt; &quot;1.50&quot;
	if length(b_factor_string) &gt; 6
		throw(ErrorException(&quot;$b_factor_string has more than 6 characters.&quot;))
	end
	@set atom.B = b_factor_string
end</code></pre><pre class="documenter-example-output">Main.ex-01_Change_B_factors.change_b_factor</pre><p>md nothing # hide</p><p>Now, we can use the <code>change_b_factor</code> function to change the B-factor of each <code>&quot;CA&quot;</code> atom:</p><pre><code class="language-julia">for res in pdb_residues
	for i in eachindex(res.atoms)
		atom = res.atoms[i]
		if atom.atom == &quot;CA&quot;
			res.atoms[i] = change_b_factor(atom, hydrophobicity[res.id.name])
		end
	end
end</code></pre><p>Finally, we can save the changed residues in a new PDB file.</p><pre><code class="language-julia">write(&quot;4zj9_hydrophobicity.pdb&quot;, pdb_residues, PDBFile)</code></pre><h2 id="Discussion"><a class="docs-heading-anchor" href="#Discussion">Discussion</a><a id="Discussion-1"></a><a class="docs-heading-anchor-permalink" href="#Discussion" title="Permalink"></a></h2><p>While we have focused on changing the B-factor field of a <code>PDBAtom</code>, you can use the same approach to change other fields. However, if you want to change atom coordinates, it is better to use the <code>change_coordinates</code> function from the PDB module of MIToS.</p><p>MIToS atoms and residues generally stores the string present in the input file without surrounding spaces. You can use the <code>Formatting</code> module to create these strings and <code>strip</code> to get rid of the spaces. You can see the <a href="https://www.wwpdb.org/documentation/file-format-content/format23/sect9.html">PDB format description</a> to know what is the format of the expected string or see the <a href="https://github.com/diegozea/MIToS.jl/blob/master/src/PDB/PDBParser.j">MIToS PDB print source code</a> to get a quick idea.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Scripts/">« Scripts</a><a class="docs-footer-nextpage" href="../02_Linking_structural_and_evolutionary_information/">Linking structural and evolutionary information »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 1 August 2020 17:40">Saturday 1 August 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
